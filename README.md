# Windows11 セットアップ自動化スクリプト

このプロジェクトは、新しいWindows11 PCの初期セットアップや開発環境の構築を自動化するための一連のスクリプトを提供します。

`config.json`ファイルにインストールしたいアプリケーションやライブラリを定義するだけで、退屈な手作業をなくし、一貫性のある環境を迅速に構築できます。

## 主な機能

- **アプリケーションの一括インストール**: `winget`を利用し、基本的なユーティリティから開発ツールまで、必要なアプリを自動でインストールします。
- **不要アプリのクリーンアップ**: Windowsにプリインストールされている不要なUWPアプリを自動で削除します。
- **開発者向けパッケージ管理**: `npm` (Node.js) と `pip` (Python) のパッケージを、`config.json`に基づいて一括でグローバルにインストールします。
    - Pythonのパッケージ管理には、高速な`uv`を利用します。
- **システム設定の最適化**: エクスプローラーの表示設定（隠しファイルや拡張子の表示など）や、高速スタートアップの無効化など、一般的なシステム設定を自動で変更します。
- **2フェーズ実行による安定性**: アプリのインストール（フェーズ1）と、それを利用するパッケージのインストール（フェーズ2）の間にPC再起動を挟むことで、`PATH`環境変数の問題を回避し、安定したセットアップを実現します。
- **Windows Updateの完全自動化**: 更新プログラムがなくなるまで、確認・ダウンロード・インストール・再起動を自動で繰り返すスクリプトも同梱しています。

## 使い方

1.  **リポジトリのクローンまたはダウンロード**
    このプロジェクトのファイルを、PCの任意の場所に配置します。

2.  **`config.json`のカスタマイズ**
    `config.json`ファイルを開き、自分の好みに合わせてインストールするアプリケーションやライブラリのリストを編集します。
    - `wingetInstall`: `winget`でインストールするアプリケーションのIDを記述します。
    - `appxRemove`: 削除したいWindows標準アプリの名称を記述します。
    - `npmInstall`: グローバルにインストールしたいnpmパッケージを記述します。
    - `pipInstall`: システムにインストールしたいPythonパッケージを記述します。

3.  **スクリプトの実行**
    `Start-Admin.bat`ファイルを**右クリック**し、「**管理者として実行**」を選択します。
    
    メニューが表示されたら、実行したいスクリプトの番号を選択してください。
    - `1. AutoWindowsUpdate`: Windows Updateを全自動で実行します。クリーンインストール後など、最初に実行することを推奨します。
    - `2. AutoSetup`: アプリのインストールや環境構築を自動で行います。

    > **[NOTE]**
    > 必ず管理者権限で実行してください。管理者でない場合、その旨を伝えるメッセージが表示され、スクリプトは自動で終了します。

4.  **自動再起動と処理の継続**
    - `AutoSetup.ps1`を実行した場合、フェーズ1の処理が完了するとPCは10秒後に自動で再起動します。再起動後にサインインすると、フェーズ2の処理（npm/pipパッケージのインストール）が自動的に開始されます。
    - `AutoWindowsUpdate.ps1`を実行した場合、必要に応じて自動で再起動し、更新がなくなるまで処理を継続します。

5.  **完了**
    コンソールウィンドウで「すべての処理が完了しました！」といったメッセージが表示されたら、すべてのプロセスは終了です。

## スクリプトの構成

- **`Start-Admin.bat`**:
  ユーザーが最初に実行するバッチファイルです。管理者権限をチェックし、メニューから`AutoSetup.ps1`や`AutoWindowsUpdate.ps1`を呼び出します。

- **`AutoSetup.ps1`**:
  セットアップ処理の中核を担うPowerShellスクリプトです。`config.json`を読み込み、2つのフェーズに分けて処理を実行します。

- **`AutoWindowsUpdate.ps1`**:
  Windows Updateを全自動で実行するためのスクリプトです。更新がなくなるまで、更新の確認・ダウンロード・インストール・再起動を自動で繰り返します。

- **`config.json`**:
  インストールするアプリケーションやパッケージを定義する設定ファイルです。このファイルを編集するだけで、セットアップ内容を自由にカスタマイズできます。

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

---
Copyright (c) 2025 sin4auto
