# Windows セットアップ自動化スクリプト

このプロジェクトは、新しいWindows PCの初期セットアップや開発環境の構築を自動化するための一連のスクリプトを提供します。

`config.json`ファイルにインストールしたいアプリケーションやライブラリを定義するだけで、退屈な手作業をなくし、一貫性のある環境を迅速に構築できます。

## 主な機能

- **アプリケーションの一括インストール**: `winget`を利用し、基本的なユーティリティから開発ツールまで、必要なアプリを自動でインストールします。
- **不要アプリのクリーンアップ**: Windowsにプリインストールされている不要なUWPアプリを自動で削除します。
- **開発者向けパッケージ管理**: `npm` (Node.js) と `pip` (Python) のパッケージを、`config.json`に基づいて一括でグローバルにインストールします。
    - Pythonのパッケージ管理には、高速な`uv`を利用します。
- **システム設定の最適化**: エクスプローラーの表示設定（隠しファイルや拡張子の表示など）や、高速スタートアップの無効化など、一般的なシステム設定を自動で変更します。
- **2フェーズ実行による安定性**: アプリのインストール（フェーズ1）と、それを利用するパッケージのインストール（フェーズ2）の間にPC再起動を挟むことで、`PATH`環境変数の問題を回避し、安定したセットアップを実現します。

## 使い方

1.  **リポジトリのクローンまたはダウンロード**
    このプロジェクトのファイルを、PCの任意の場所に配置します。

2.  **`config.json`のカスタマイズ**
    `config.json`ファイルを開き、自分の好みに合わせてインストールするアプリケーションやライブラリのリストを編集します。
    - `wingetInstall`: `winget`でインストールするアプリケーションのIDを記述します。
    - `appxRemove`: 削除したいWindows標準アプリの名称を記述します。
    - `npmInstall`: グローバルにインストールしたいnpmパッケージを記述します。
    - `pipInstall`: システムにインストールしたいPythonパッケージを記述します。

3.  **スクリプトの実行**
    `AutoSetup.bat`ファイルを**右クリック**し、「**管理者として実行**」を選択します。
    
    メニューが表示されたら、`2` を選択して`AutoSetup.ps1`を実行します。

    > **[NOTE]**
    > 必ず管理者権限で実行してください。管理者でない場合、その旨を伝えるメッセージが表示され、スクリプトは自動で終了します。

4.  **自動再起動とフェーズ2の実行**
    フェーズ1の処理が完了すると、PCは10秒後に自動で再起動します。
    
    再起動後にサインインすると、フェーズ2の処理（npm/pipパッケージのインストール）が自動的に開始されます。

5.  **完了**
    フェーズ2のコンソールウィンドウで「すべてのセットアップ処理が完了しました！」と表示されたら、すべてのプロセスは終了です。

## スクリプトの構成

- **`AutoSetup.bat`**:
  ユーザーが最初に実行するバッチファイルです。管理者権限をチェックし、メニューからPowerShellスクリプトを呼び出します。

- **`AutoSetup.ps1`**:
  セットアップ処理の中核を担うPowerShellスクリプトです。`config.json`を読み込み、2つのフェーズに分けて処理を実行します。

- **`config.json`**:
  インストールするアプリケーションやパッケージを定義する設定ファイルです。このファイルを編集するだけで、セットアップ内容を自由にカスタマイズできます。

- **`AutoWindowsUpdate.ps1`** (オプション):
  Windows Updateを強制的に実行するためのスクリプトです。

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

---
Copyright (c) 2025 sin4auto