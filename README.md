# Windows PC キッティング自動化スクリプト

Windows PCのキッティング（初期セットアップ）から開発環境構築までの一連の作業を自動化する、PowerShellスクリプト群です。

人間が読みやすい **`config.yaml`** に、コメントを使って分かりやすく設定を定義するだけで、手作業による時間のかかるセットアップ作業を大幅に削減し、誰でも一貫性のある環境を迅速に構築できます。

## コンセプト

このリポジトリは、従来手作業で行われていたキッティング作業（OSのクリーンインストール後の各種設定やアプリケーションのインストールなど）を、可能な限り自動化することを目的としています。

手作業のプロセスで起こりがちな設定ミスや作業漏れを防ぎ、再現性の高い環境構築を実現します。

## 主な機能

- **Windows Updateの完全自動化**: 更新プログラムがなくなるまで、確認・インストール・再起動を無人で繰り返します。
- **柔軟なアプリケーション管理**: `winget` を利用し、`config.yaml` に基づいてアプリの一括インストールや不要なプリインストールアプリの削除を行います。
- **開発環境の自動構築**: `npm` (Node.js) や `pip` (Python) のパッケージを自動でインストールします。Python環境には高速な `uv` を利用します。
- **システム設定のデータ駆動化**: エクスプローラーの拡張子表示などのシステム設定を`config.yaml`に直接記述することで、スクリプトを編集することなく柔軟に設定を変更できます。
- **安定した2フェーズ実行**: アプリインストール（フェーズ1）と、PATH環境変数を参照する開発ツール（フェーズ2）の間に再起動を挟むことで、安定した動作を保証します。
- **対話的な操作メニュー**: `Start-Admin.bat` を実行するだけで、ユーザーはメニューから実行したい処理を簡単に選択できます。

## 推奨ワークフロー

1.  **OSのクリーンインストール**: Windows 11をクリーンインストールします。
2.  **リポジトリの配置**: このリポジトリのファイルをPCの任意の場所（例: `C:\Work`）に配置します。
3.  **設定ファイルの編集**: `config.yaml` をテキストエディタで開き、インストールしたいアプリケーションや不要な設定項目を、行頭に `#` を付けてコメントアウトし、自分の好みに合わせて編集します。
4.  **スクリプトの実行**:
    1.  `Start-Admin.bat` を**右クリック**し、「**管理者として実行**」を選択します。
    2.  メニューから `1. AutoWindowsUpdate` を選択し、OSを最新の状態にします。（**強く推奨**）
    3.  処理が完了したら、再度 `Start-Admin.bat` を管理者として実行します。
    4.  メニューから `2. AutoSetup` を選択し、アプリケーションのインストールと環境構築を開始します。
5.  **最終確認**:
    - すべての自動処理が完了したら、PCを一度手動で再起動します。
    - Windows Updateの画面やデバイスマネージャーを開き、更新漏れや不明なデバイスがないか最終確認を行います。

## スクリプト構成

| ファイル名                  | 役割                                                                                                                             |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `Start-Admin.bat`           | **起点となるファイル。** 管理者権限を確認し、対話形式で実行するスクリプトを選択させます。                                         |
| `Update-Windows.ps1`        | Windows Updateを全自動で実行します。更新がなくなるまで、更新の確認・インストール・再起動を繰り返します。                           |
| `AutoSetup.ps1`             | `config.yaml` に基づき、アプリのインストール、システム設定、開発環境の構築を2フェーズ（再起動を挟む）に分けて実行します。          |
| `config.yaml`               | **カスタマイズの中心。** インストールするアプリ、システム設定、開発パッケージなどを、コメント付きで分かりやすく定義します。          |
| `.gitignore`                | ログファイルなど、Gitの管理対象から除外するファイルを指定します。                                                                 |
| `キッティング手順.txt`      | 自動化スクリプトを使用する際の、手動作業を含めた全体的な作業フローのメモです。                                                   |

## カスタマイズ

セットアップ内容は `config.yaml` を編集することで自由にカスタマイズできます。不要な項目は行頭に `#` を付けてコメントアウトしてください。

### フェーズ1 (`phase1`)

再起動前に実行される基本的なシステムセットアップを定義します。

- `wingetInstall`: `winget` でインストールするアプリのIDと、必要に応じてインストールオプションを記述します。
- `appxRemove`: 削除したいWindows標準アプリの名称（ワイルドカード使用可）を記述します。
- `otherTasks`: `upgradeAllApps` など、リスト形式ではない固定タスクの実行を `true`/`false` で制御します。
- `windowsTweaks`: レジストリ変更を伴うシステム設定を、`description`, `type`, `path` などのキーで詳細に定義します。

### フェーズ2 (`phase2`)

再起動後に実行される開発者向けパッケージのインストールを定義します。

- `npmInstall`: `npm install -g` でグローバルにインストールしたいNode.jsパッケージ名を記述します。
- `pipInstall`: `uv pip install --system` でインストールしたいPythonパッケージ名を記述します。
- (`cargoInstall`など): `AutoSetup.ps1`の定義を参考に、新しいパッケージマネージャーのセクションを自由に追加できます。

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。

---
Copyright (c) 2025 sin4auto