# ================================================================
# AutoSetupスクリプト設定ファイル
# ================================================================
# 実行したいタスクをフェーズごとに定義します。
# 不要な項目は、行頭に「#」を付けてコメントアウトするとスキップされます。

# ----------------------------------------------------------------
# ■ フェーズ1: システムの基本セットアップ
# ----------------------------------------------------------------
phase1:
  # --- Wingetによるアプリケーションのインストール ---
  wingetInstall:
    - id: Microsoft.PowerShell                 # 最新のPowerShell
    - id: Google.Chrome                        # Webブラウザ
    - id: 7zip.7zip                            # 高性能なファイル圧縮・解凍ソフト
    - id: Microsoft.PowerToys                  # Windowsを便利にするユーティリティ集
    - id: Zoom.Zoom                            # Web会議ツール
    - id: Git.Git                              # バージョン管理システム
    - id: OpenJS.NodeJS.LTS                    # JavaScript実行環境 (長期サポート版)
    - id: Python.Python.3.12                   # プログラミング言語 Python
    - id: astral-sh.uv                         # 高速なPythonパッケージインストーラー
    - id: Microsoft.VisualStudioCode           # 統合開発環境 (IDE)
      options: '--override "/SILENT /NORESTART /MERGETASKS=!runcode,desktopicon,addcontextmenufiles,addcontextmenufolders,associatewithfiles,addtopath"'
    - id: Adobe.Acrobat.Reader.64-bit          # PDF閲覧ソフト
      options: '--override "/sAll /rs /rps /msi EULA_ACCEPT=YES"'

  # --- 不要なプリインストールアプリの削除 ---
  appxRemove:
    - name: "*Cortana*"                        # AIアシスタント
    - name: "*Microsoft.BingNews*"             # ニュースアプリ
    - name: "*Microsoft.GetHelp*"              # ヘルプ表示アプリ
    - name: "*Microsoft.Getstarted*"           # ヒント表示アプリ
    - name: "*Microsoft.Office.OneNote*"       # OneNote (ストアアプリ版)
    - name: "*Microsoft.People*"               # People (連絡先) アプリ
    - name: "*Microsoft.WindowsFeedbackHub*"   # フィードバックHub
    - name: "*Microsoft.YourPhone*"            # スマートフォン連携
    - name: "*Microsoft.ZuneMusic*"            # Grooveミュージック
    - name: "*Microsoft.ZuneVideo*"            # 映画 & テレビ

  # --- Windowsのシステム設定変更 ---
  windowsTweaks:
    - description: 隠しファイルとフォルダを表示する
      type: Set-RegistryValue # レジストリの値を設定
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
      name: Hidden
      value: 1
      valueType: DWord
    - description: ファイルの拡張子を常に表示する
      type: Set-RegistryValue
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
      name: HideFileExt
      value: 0
      valueType: DWord
    - description: エクスプローラーのアドレスバーに完全なパスを表示する
      type: Set-RegistryValue
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState
      name: FullPathAddress
      value: 1
      valueType: DWord
    - description: エクスプローラーの起動時に「PC」を表示する
      type: Set-RegistryValue
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
      name: LaunchTo
      value: 1
      valueType: DWord
    - description: 高速スタートアップを無効化する
      type: Set-RegistryValue
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power
      name: HiberbootEnabled
      value: 0
      valueType: DWord
    - description: 右クリックメニューを従来のスタイルに戻す (Win11)
      type: Create-RegistryKeyWithDefault # キーを作成し、その既定値を設定
      path: HKCU:\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32
      value: "" # 空の既定値を設定

# ----------------------------------------------------------------
# ■ フェーズ2: 開発者向けパッケージのインストール（再起動後）
# ----------------------------------------------------------------
phase2:
  # =================================================================
  # ■ パッケージマネージャーとインストールするパッケージの定義
  # =================================================================
  # ここでは、コマンドと引数をリスト形式で定義し、安全な実行を可能にします。
  packageManagers:
    # --- npm (Node.js) の設定 ---
    - managerName: 'npm'                                            # 管理者の表示名 (ログ用)
      commandName: 'npm'                                            # 実行するコマンド名
      checkArgs: ['list', '-g', '{package}', '--depth=0']           # インストール済みか確認するための引数
      installArgs: ['install', '-g', '{package}']                   # インストールを実行するための引数
      packages:                                                     # インストールするパッケージのリスト
        - typescript                                                # 静的型付けJavaScript
        - ts-node                                                   # TypeScriptを直接実行
        - nodemon                                                   # ファイル変更時に自動でサーバーを再起動
        - eslint                                                    # コードの静的解析ツール
        - prettier                                                  # コードフォーマッター
        - pnpm                                                      # 高速なパッケージマネージャー

    # --- pip (Python) の設定 (uvを使用) ---
    - managerName: 'pip'                                            # 管理者の表示名 (ログ用)
      commandName: 'uv'                                             # 実行するコマンド名
      checkArgs: ['pip', 'show', '{package}']                       # インストール済みか確認するための引数
      installArgs: ['pip', 'install', '{package}', '--system']      # インストールを実行するための引数
      packages:                                                     # インストールするパッケージのリスト
        - jupyterlab                                                # 対話的なデータ分析・開発環境
        - jupyterlab-language-pack-ja-jp                            # JupyterLabの日本語化パック
        - requests                                                  # HTTP通信ライブラリ
        - numpy                                                     # 数値計算ライブラリ
        - pandas                                                    # データ分析ライブラリ
        - matplotlib                                                # データ可視化・グラフ描画ライブラリ
        - black                                                     # コードフォーマッター
        - ruff                                                      # 高速なリンター
        - python-dotenv                                             # .envファイルから環境変数を読み込む
        - scikit-learn                                              # 機械学習ライブラリ
        - seaborn                                                   # 統計的データ可視化ライブラリ
        - openpyxl                                                  # Excelファイルの読み書き
        - fastapi                                                   # 高速なWebフレームワーク
        - lxml                                                      # XML/HTMLパーサー

    # --- cargo (Rust) の設定例 ---
    # 注: cargoの確認コマンドはパイプライン(|)を含むため、このスクリプトでは直接サポートしていません。
    # checkArgsを修正するか、インストール済でも再実行を許容する運用を検討してください。
    # - managerName: 'cargo'                                         # 管理者の表示名 (ログ用)
    #   commandName: 'cargo'                                         # 実行するコマンド名
    #   checkArgs: ['install', '--list']                             # インストール済みか確認するための引数 (※要修正)
    #   installArgs: ['install', '{package}']                        # インストールを実行するための引数
    #   packages:                                                    # インストールするパッケージのリスト
    #     - ripgrep                                                  # 高速なgrep代替ツール
    #     - bat                                                      # シンタックスハイライト付きcat
    #     - fd-find                                                  # 高速なfind代替ツール